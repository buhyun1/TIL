<%@ page language="java" contentType="text/html; charset=EUC-KR"
	pageEncoding="EUC-KR"%>
<%@ page import="java.io.File"%>
<%@ page import="java.util.*"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="EUC-KR">
<title>Insert title here</title>
</head>
<body>
	<h2>deleted files</h2>
	<%
	String uploadFolder = this.getServletContext().getInitParameter("uploadFolder");
	String uploadPath = this.getServletContext().getRealPath(uploadFolder);
	File folders = new File(uploadPath);
	String userID = request.getParameter("userid");
	String password = request.getParameter("pw");
	//System.out.println(file.getAbsolutePath());
	Enumeration<String> params = request.getParameterNames();
	//Cookie를 통해 로그인 한 유저 Email 받아오기
	Cookie[] c = request.getCookies();
	String UserID = "";
	if (c != null) {
		for (int i = 0; i < c.length; i++) {
			//Cookie중 LoginOK 쿠키가 있는 경우에만 진행
			if (c[i].getName().equals("LoginOK")) {
		//UserID변수에 Cookie에 들어있는 ID저장
		UserID = c[i].getValue();
		System.out.println("Logined User:" + UserID);
			}

		}
	}

	out.println("<ul>");
	while (params.hasMoreElements()) {
		String param = params.nextElement();
		System.out.println(param);
		out.println("<li>" + param + "</li>");

		File file3 = new File(uploadPath + UserID + "\\" + param);
		
        File[] files = folders.listFiles();
        System.out.println(files);
        if (files.equals(param)) {
            for (File file : files) {
                if (file.isFile()) {
                    file.delete();
                } 
            }
            
        }
        file3.delete();
		/**
        if (file3.exists()) {
			System.out.print("있다!" + file3.getAbsolutePath());
			
		} else {
			System.out.print("없다!" + file3.getAbsolutePath());
		}

		file3.delete();
		**/

	}
	out.println("</ul>");
	
	
	%>

	<form action="sample_management.jsp" method="post">
		<input type="hidden" name="userid" value="<%=userID%>" /> <input
			type="hidden" name="pw" value="<%=password%>" /> <input
			type="submit" value="Go back to file list" />
	</form>
</body>
</html>